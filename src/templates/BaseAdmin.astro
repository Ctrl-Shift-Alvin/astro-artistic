---
import { AdminButtonContainer } from '@/components/partials/admin/AdminButtonContainer';
import { logout } from '@/frontend/adminApi';
import { GlobalTranslation } from '@/locales/global';
import Base from '@/templates/Base.astro';

interface Props {
	head: {
		title: string;
		description: string;
	}
	noLogoutComponent?: boolean;
}

const { head } = Astro.props;

const title = `${GlobalTranslation.siteName} - Admin - ${head.title}`;
const description = `${GlobalTranslation.siteName} - Admin - ${head.description}`;

const pathname = Astro.url.pathname;
const prevUrl = decodeURIComponent(Astro.url.searchParams.get('prevUrl') ?? '');

const adminButtons = pathname !== '/admin/home/'
	? [
		{
			children: 'Back',
			href: prevUrl || '/admin/home/'
		}
	]
	: undefined;
---

<Base head={{ title, description }}>

	<slot />
	<AdminButtonContainer buttons={adminButtons} client:only="react">
		{
			{
				children: 'Logout',
				onClick: () => void logout()
			}
		}
	</AdminButtonContainer>
	<script>

		import { setLogoutTimeout } from '@/frontend/adminApi';
		setLogoutTimeout();

	</script>
</Base>